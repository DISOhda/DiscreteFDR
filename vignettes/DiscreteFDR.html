<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to DiscreteFDR</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to DiscreteFDR</h1>



<p>Multiple testing procedures are important tools for identifying
statistically significant findings in massive and complex data while
controlling a specific error rate. An important focus has been given to
methods controlling the false discovery rate (FDR), i.e., the expected
proportion of falsely rejected hypotheses among all rejected hypotheses,
which has become the standard error rate for high dimensional data
analysis. Since the original procedure of <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x">Benjamini and
Hochberg (1995)</a>, much effort has been undertaken to design FDR
controlling procedures that adapt to various underlying structures of
the data, such as the quantity of signal, the signal strength and the
dependencies, among others.</p>
<p>The <strong>R</strong> package <strong>DiscreteFDR</strong>,
presented in this paper, deals with adaptation to discrete and
non-identically distributed test statics by implementing procedures
developed by <a href="https://doi.org/10.1214/18-EJS1441">Döhler, Durand
and Roquain (2018)</a> (in the sequel abbreviated as <a href="https://doi.org/10.1214/18-EJS1441">[DDR]</a>). This type of data
arises in many relevant applications, in particular when data represent
frequencies or counts. Examples can be found in clinical studies (see
e.g., <a href="https://doi.org/10.1080/00031305.1997.10473577">Westfall
and Wolfinger (1997)</a>), genome-wide association studies (GWAS) (see
e.g., <a href="https://www.degruyter.com/view/j/sagmb.2012.11.issue-4/1544-6115.1776/1544-6115.1776.xml">Dickhaus,
Straßburger et al. (2012)</a>) and next generation sequencing data (NGS)
(see e.g., <a href="https://arxiv.org/abs/1502.00973">Doerge and Chen
(2015)</a>}).</p>
<hr />
<div id="a-toy-example" class="section level1">
<h1>1. A Toy example</h1>
<p>To give a first impression of how <strong>DiscreteFDR</strong> works,
we consider an artificial toy example. A more realistic example
involving pharmacovigilance data is given in Section 2.</p>
<p>Suppose we would like to compare two treatments in nine different
populations. For each population we do this by evaluating the responders
and non-responders for each treatment. This leads to categorical data
which can be represented, for each population <span class="math inline">\(i = 1, \ldots, 9\)</span> in the following 2 <span class="math inline">\(\times\)</span> 2 table:</p>
<table>
<colgroup>
<col width="16%" />
<col width="26%" />
<col width="26%" />
<col width="31%" />
</colgroup>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Responders</th>
<th align="center">Non-responders</th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Treatment 1</td>
<td align="center"><span class="math inline">\(x_{1i}\)</span></td>
<td align="center"><span class="math inline">\(y_{1i}\)</span></td>
<td align="center"><span class="math inline">\(n_{1i}\)</span></td>
</tr>
<tr class="even">
<td align="left">Treatment 2</td>
<td align="center"><span class="math inline">\(x_{2i}\)</span></td>
<td align="center"><span class="math inline">\(y_{2i}\)</span></td>
<td align="center"><span class="math inline">\(n_{2i}\)</span></td>
</tr>
<tr class="odd">
<td align="left"><strong>Total</strong></td>
<td align="center"><span class="math inline">\(x_{1i} +
x_{2i}\)</span></td>
<td align="center"><span class="math inline">\(y_{1i} +
y_{2i}\)</span></td>
<td align="center"><span class="math inline">\(n = n_{1i} +
n_{2i}\)</span></td>
</tr>
</tbody>
</table>
<p>Denoting the responder probabilities for population <span class="math inline">\(i\)</span> by <span class="math inline">\(\pi_{1i}\)</span> and <span class="math inline">\(\pi_{2i}\)</span> we can test e.g.</p>
<p><span class="math display">\[H_{0i}: \pi_{1i} = \pi_{2i} \qquad
\text{vs.} \qquad H_{1i}: \pi_{1i} \neq \pi_{2i}\]</span></p>
<p>by using Fisher’s (two-sided) exact test (see <a href="https://doi.org/10.1214/009053605000000084">Lehmann and Romano
(2006)</a>), which is implemented in the <strong>R</strong> function
<code>fisher.test</code>. Suppose the data in the nine populations are
independent and we observe the following data frame <code>df</code></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">148</span>, <span class="dv">9</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">132</span>, <span class="dv">9</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>Y1 <span class="ot">&lt;-</span> N1 <span class="sc">-</span> X1</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>Y2 <span class="ot">&lt;-</span> N2 <span class="sc">-</span> X2</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X1, Y1, X2, Y2)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">kable</span>(df, <span class="at">caption =</span> <span class="st">&quot;Toy Example&quot;</span>)</span></code></pre></div>
<table>
<caption>Toy Example</caption>
<thead>
<tr class="header">
<th align="right">X1</th>
<th align="right">Y1</th>
<th align="right">X2</th>
<th align="right">Y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">144</td>
<td align="right">0</td>
<td align="right">132</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">146</td>
<td align="right">0</td>
<td align="right">132</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">146</td>
<td align="right">1</td>
<td align="right">131</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">134</td>
<td align="right">3</td>
<td align="right">129</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">142</td>
<td align="right">2</td>
<td align="right">130</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">139</td>
<td align="right">1</td>
<td align="right">131</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">144</td>
<td align="right">2</td>
<td align="right">130</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">148</td>
<td align="right">2</td>
<td align="right">130</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">147</td>
<td align="right">2</td>
<td align="right">130</td>
</tr>
</tbody>
</table>
<p>In this data frame each of the 9 rows represents the data of an
observed 2 <span class="math inline">\(\times\)</span> 2 table: e.g.,
the third row of the data corresponds to <span class="math inline">\(x_{13} = 2, y_{13} = 146, x_{23} = 1, y_{23} =
131\)</span>. Even though in this example, the total number of tested
hypotheses <span class="math inline">\(m = 9\)</span> is very small, for
illustrative purposes we deal with the multiplicity problem here by
controlling FDR at level <span class="math inline">\(\alpha =
5\%\)</span>. The DBH step-down procedure can be applied directly to the
data frame object <code>df</code> and yields an S3 object of class
<code>DiscreteFDR</code>, for which we provide both <code>print</code>
and <code>summary</code> methods:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;DiscreteFDR&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>DBH.sd.fast <span class="ot">&lt;-</span> <span class="fu">fast.Discrete</span>(df, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="at">direction =</span> <span class="st">&quot;sd&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="fu">print</span>(DBH.sd.fast)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;   Discrete Benjamini-Hochberg procedure (step-down) </span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt; data:  df </span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt; number of tests = 9 </span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt; number of rejections = 2 at global FDR level 0.05 </span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt; (Original BH rejections = 0)</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt; largest rejected p value:  0.02126871</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="fu">summary</span>(DBH.sd.fast)</span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt;   Discrete Benjamini-Hochberg procedure (step-down) </span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt; data:  df </span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt; number of tests = 9 </span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt; number of rejections = 2 at global FDR level 0.05 </span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt; (Original BH rejections = 0)</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="co">#&gt; largest rejected p value:  0.02126871 </span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a><span class="co">#&gt;   Index    P.value   Adjusted Rejected</span></span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a><span class="co">#&gt; 1     4 0.01243145 0.03819796     TRUE</span></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a><span class="co">#&gt; 2     6 0.02126871 0.03819796     TRUE</span></span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a><span class="co">#&gt; 3     1 0.12476691 0.25630985    FALSE</span></span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a><span class="co">#&gt; 4     8 0.22135177 0.47895996    FALSE</span></span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a><span class="co">#&gt; 5     5 0.28849298 0.51482782    FALSE</span></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co">#&gt; 6     2 0.49984639 1.00000000    FALSE</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a><span class="co">#&gt; 7     9 0.60329543 1.00000000    FALSE</span></span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a><span class="co">#&gt; 8     7 0.68723229 1.00000000    FALSE</span></span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a><span class="co">#&gt; 9     3 1.00000000 1.00000000    FALSE</span></span></code></pre></div>
<p>The output of the <code>summary</code> function contains the same
output as the <code>print</code> method, but adds a table that lists the
raw <span class="math inline">\(p\)</span>-values, their adjusted
counterparts and their respective rejection decision. It is sorted by
raw <span class="math inline">\(p\)</span>-values in ascending order.
Our <code>summary</code> method actually creates a
<code>summary.DiscreteFDR</code> object, which includes all contents of
an <code>DiscreteFDR</code> object plus the aforementioned table. This
table can be accessed directly by the <code>$Table</code> command.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>DBH.sd.fast.summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(DBH.sd.fast)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>DBH.sd.fast.summary<span class="sc">$</span>Table</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt;   Index    P.value   Adjusted Rejected</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; 1     4 0.01243145 0.03819796     TRUE</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; 2     6 0.02126871 0.03819796     TRUE</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; 3     1 0.12476691 0.25630985    FALSE</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="co">#&gt; 4     8 0.22135177 0.47895996    FALSE</span></span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; 5     5 0.28849298 0.51482782    FALSE</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt; 6     2 0.49984639 1.00000000    FALSE</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt; 7     9 0.60329543 1.00000000    FALSE</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; 8     7 0.68723229 1.00000000    FALSE</span></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a><span class="co">#&gt; 9     3 1.00000000 1.00000000    FALSE</span></span></code></pre></div>
<p>Thus we can reject two hypotheses at FDR-level <span class="math inline">\(\alpha = 5\%\)</span>. Note, that our
<code>print</code> method also gives the number of rejections of the
usual (continuous) BH procedure. In order to compare its adjusted <span class="math inline">\(p\)</span>-values with ours, we have to determine
the raw <span class="math inline">\(p\)</span>~values first. This would
be possible by applying the <code>fisher.test</code> function to all
nine 2 <span class="math inline">\(\times\)</span> 2 tables.
Alternatively, we may use the more convenient function
<code>fisher.pvalues.support</code> included in our package for
accessing the raw <span class="math inline">\(p\)</span>-values. An even
more simple way is to extract them from an object that contains the
results:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">fisher.pvalues.support</span>(df, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>raw.pvalues <span class="ot">&lt;-</span> p<span class="sc">$</span>raw</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># or:</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>raw.pvalues2 <span class="ot">&lt;-</span> DBH.sd.fast<span class="sc">$</span>Data<span class="sc">$</span>raw.pvalues</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="fu">all</span>(raw.pvalues <span class="sc">==</span> raw.pvalues2)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co">#&gt; [1] TRUE</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="fu">p.adjust</span>(raw.pvalues, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; [1] 0.37430072 0.74976959 1.00000000 0.09570921 0.51928737 0.09570921 0.77313633</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; [8] 0.49804147 0.77313633</span></span></code></pre></div>
<p>Applying the continuous BH procedure from the <strong>stats</strong>
package in the last line of code, we find that we can not reject any
hypotheses at FDR-level <span class="math inline">\(\alpha =
5\%\)</span>. Another approach of determining this is to compare the
critical values of the discrete and continuous BH procedures. In the
discrete case, we need the observed <span class="math inline">\(p\)</span>-values their distributions. Both were
computed by our <code>fisher.pvalues.support</code> function above.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">fisher.pvalues.support</span>(df, <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>raw.pvalues <span class="ot">&lt;-</span> p<span class="sc">$</span>raw</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>pCDFlist <span class="ot">&lt;-</span> p<span class="sc">$</span>support</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>DBH.sd.crit <span class="ot">&lt;-</span> <span class="fu">DBH</span>(raw.pvalues, pCDFlist, <span class="fl">0.05</span>, <span class="st">&quot;sd&quot;</span>, <span class="cn">TRUE</span>)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>crit.vals.BH.disc <span class="ot">&lt;-</span> DBH.sd.crit<span class="sc">$</span>Critical.values</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>crit.vals.BH.cont <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span> <span class="sc">*</span> <span class="fl">0.05</span><span class="sc">/</span><span class="dv">9</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">cbind</span>(<span class="fu">sort</span>(raw.pvalues), crit.vals.BH.disc, crit.vals.BH.cont)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="co">#&gt;                  crit.vals.BH.disc crit.vals.BH.cont</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="co">#&gt;  [1,] 0.01243145        0.01243145       0.005555556</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="co">#&gt;  [2,] 0.02126871        0.02832448       0.011111111</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="co">#&gt;  [3,] 0.12476691        0.03109596       0.016666667</span></span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a><span class="co">#&gt;  [4,] 0.22135177        0.04839433       0.022222222</span></span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a><span class="co">#&gt;  [5,] 0.28849298        0.05014119       0.027777778</span></span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a><span class="co">#&gt;  [6,] 0.49984639        0.07657062       0.033333333</span></span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="co">#&gt;  [7,] 0.60329543        0.07657062       0.038888889</span></span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="co">#&gt;  [8,] 0.68723229        0.10328523       0.044444444</span></span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="co">#&gt;  [9,] 1.00000000        0.10328523       0.050000000</span></span></code></pre></div>
<p>Obviously, the critical values of the discrete approach are
considerably larger than those of the continuous method. As a result,
the two smallest <span class="math inline">\(p\)</span>-values are
rejected by the discrete BH procedure, because they are smaller than or
equal to the respective critical values. The continuous BH approach does
not reject any hypothesis, because all its critical values are smaller
than the observed <span class="math inline">\(p\)</span>-values.</p>
<p>For illustration, our package includes a <code>plot</code> method for
<code>DiscreteFDR</code> S3 class objects. It allows to define colors,
line types and point characters separately for accepted and rejected
<span class="math inline">\(p\)</span>-values and for critical values
(if present in the object).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">plot</span>(DBH.sd.crit, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">19</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type.crit =</span> <span class="st">&#39;o&#39;</span>,</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>     <span class="at">legend =</span> <span class="st">&quot;topleft&quot;</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Now, it is visible which observed <span class="math inline">\(p\)</span>-values are rejected. A comparison with
the continuous BH procedure could be done as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">plot</span>(DBH.sd.crit, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">19</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">type.crit =</span> <span class="st">&#39;o&#39;</span>,</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.3</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="at">main =</span> <span class="st">&quot;Comparison of discrete and continuous BH procedures&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="fu">points</span>(crit.vals.BH.cont, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">1.3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Rejected&quot;</span>, <span class="st">&quot;Accepted&quot;</span>, <span class="st">&quot;Critical Values (disc.)&quot;</span>, <span class="st">&quot;Critical Values (cont.)&quot;</span>),</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">19</span>, <span class="dv">19</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">lty =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>As this example illustrates, the discrete approach can potentially
yield a large increase in power. The gain depends on the involved
distribution functions and the raw <span class="math inline">\(p\)</span>-values. To appreciate where this comes
from, it is instructive to consider the distribution functions <span class="math inline">\(F_1, \ldots, F_9\)</span> of the <span class="math inline">\(p\)</span>-values under the null in more detail.
Take for instance the first 2 <span class="math inline">\(\times\)</span> 2 table:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Responders</th>
<th align="center">Non-responders</th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Treatment 1</td>
<td align="center">4</td>
<td align="center">144</td>
<td align="center">148</td>
</tr>
<tr class="even">
<td align="left">Treatment 2</td>
<td align="center">0</td>
<td align="center">132</td>
<td align="center">132</td>
</tr>
<tr class="odd">
<td align="left"><strong>Total</strong></td>
<td align="center">4</td>
<td align="center">276</td>
<td align="center">280</td>
</tr>
</tbody>
</table>
<p>Fisher’s exact test works by determining the probability of observing
this (or a more ‘extreme’) table, given that the margins are fixed. So
each <span class="math inline">\(F_i\)</span> is determined by the
margins of table <span class="math inline">\(i\)</span>. Since <span class="math inline">\(x_{11} + x_{21} = 4\)</span>, the only potentially
observable tables are given by <span class="math inline">\(x_{11} = 0,
\ldots, 4\)</span>. For each one of these 5 values a <span class="math inline">\(p\)</span>-value can be determined using the
hypergeometric distribution. Therefore, the <span class="math inline">\(p\)</span>-value of any 2 <span class="math inline">\(\times\)</span> 2 table with margins given by the
above table can take (at most) 5 distinct values, say <span class="math inline">\(x_1, \ldots, x_5\)</span>. Combining these 5
values into a set, we obtain the <em>support</em> <span class="math inline">\(\mathcal{A}_1 = \{x_1, \ldots, x_5\}\)</span> of
distribution <span class="math inline">\(F_1\)</span>. Now we can
continue in this vein for the remaining 2 <span class="math inline">\(\times\)</span> 2 tables to obtain the supports
<span class="math inline">\(\mathcal{A}_1, \ldots,
\mathcal{A}_9\)</span> for the distribution functions <span class="math inline">\(F_1, \ldots, F_{9}\)</span>. The supports can be
accessed via the <code>$support</code> command, e.g.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>p<span class="sc">$</span>support[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)]</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="co">#&gt; [[1]]</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a><span class="co">#&gt; [1] 0.04820493 0.12476691 0.34598645 0.62477763 1.00000000</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="co">#&gt; [[2]]</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.002173856 0.007733719 0.028324482 0.069964309 0.154043258 0.288492981</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="co">#&gt; [7] 0.481808361 0.726262402 1.000000000</span></span></code></pre></div>
<p>returns <span class="math inline">\(\mathcal{A}_1\)</span> and <span class="math inline">\(\mathcal{A}_5\)</span>. Panel (a) in the following
figure shows a graph of the distribution functions <span class="math inline">\(F_1, \ldots, F_9\)</span>. Each <span class="math inline">\(F_i\)</span> is a step-function with <span class="math inline">\(F_i(0) = 0\)</span>, the jumps occurring only on
the support <span class="math inline">\(\mathcal{A}_i\)</span> and <span class="math inline">\(F_i(x) = x\)</span> only for <span class="math inline">\(x \in \mathcal{A}_i\)</span>. In particular, all
distributions are stochastically larger than the uniform distribution
(i.e., <span class="math inline">\(F_i(x) \le x\)</span>), but in a
heterogeneous manner. This heterogeneity can be exploited e.g., by
transforming the raw <span class="math inline">\(p\)</span>-values from
the exact Fisher’s test using the function <span class="math display">\[\displaystyle \xi_{\text{SD}}(x) = \sum_{i =
1}^{9} \frac{F_i(x)}{1 - F_i(x)}.\]</span> Panel (b) shows that <span class="math inline">\(\xi_{\text{SD}}\)</span> is a step function. Its
jumps occur on the joint support <span class="math inline">\(\mathcal{A}= \mathcal{A}_1 \cup \ldots \cup
\mathcal{A}_9\)</span>. Panel (b) also shows that <span class="math inline">\(\displaystyle \xi_{\text{SD}}(x) \ll x\)</span>,
at least for small values of <span class="math inline">\(x\)</span>. It
turns out that the critical values of our new DBH step-down procedure
are essentially given by inverting <span class="math inline">\(\xi_{\text{SD}}\)</span> at the critical values of
the [BH] procedure <span class="math inline">\(1 \cdot \alpha / 9, 2
\cdot \alpha / 9, \ldots, \alpha\)</span>, so that these values are
considerably larger than the [BH] critical values. This is illustrated
in panel (c) along with the ordered <span class="math inline">\(p\)</span>~values. In particular, all asterisks
are located above the green [BH] dots, therefore this procedure can not
reject any hypothesis. In contrast, the two smallest <span class="math inline">\(p\)</span>~values are located below red DBH
step-down dots, so that this procedure rejects two hypotheses as we had
already seen earlier.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>pCDFlist <span class="ot">&lt;-</span> p<span class="sc">$</span>support</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>stepf <span class="ot">&lt;-</span> <span class="fu">lapply</span>(pCDFlist, <span class="cf">function</span>(x) <span class="fu">stepfun</span>(x, <span class="fu">c</span>(<span class="dv">0</span>, x)))</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">mai =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>))</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="fu">plot</span>(stepf[[<span class="dv">1</span>]], <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">do.points =</span> <span class="cn">FALSE</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">ylab =</span> <span class="st">&quot;F(x)&quot;</span>, </span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;(a)&quot;</span>)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> (<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>)){</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  <span class="fu">plot</span>(stepf[[i]], <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">do.points =</span> <span class="cn">FALSE</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> i)</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>}</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#   Plot xi</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>support <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">unlist</span>(pCDFlist)))</span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>components <span class="ot">&lt;-</span> <span class="fu">lapply</span>(stepf, <span class="cf">function</span>(s){<span class="fu">s</span>(support) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">s</span>(support))}) </span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>xi.values <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">9</span> <span class="sc">*</span> <span class="fu">Reduce</span>(<span class="st">&#39;+&#39;</span>, components)</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a>xi <span class="ot">&lt;-</span> <span class="fu">stepfun</span>(support, <span class="fu">c</span>(<span class="dv">0</span>, xi.values))</span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="fu">plot</span>(xi, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.10</span>), <span class="at">do.points =</span> <span class="cn">FALSE</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(xi), <span class="at">main =</span> <span class="st">&quot;(b)&quot;</span>)</span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#   Plot discrete critical values as well a BH constants and raw p-values</span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a>DBH.sd <span class="ot">&lt;-</span> <span class="fu">DBH</span>(raw.pvalues, pCDFlist, <span class="at">direction =</span> <span class="st">&quot;sd&quot;</span>, <span class="at">ret.crit.consts =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="fu">plot</span>(DBH.sd, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">19</span>), <span class="at">type.crit =</span> <span class="st">&#39;p&#39;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>),</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.3</span>, <span class="at">main =</span> <span class="st">&quot;(c)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Critical Values&quot;</span>)</span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="fl">0.05</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">/</span> <span class="dv">9</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)</span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Figure 1&quot;</span>, <span class="dv">1</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" />
Panel (a) depicts the distribution functions <span class="math inline">\(F_1, \ldots, F_9\)</span> in various colors, (b)
is a graph of the transformation <span class="math inline">\(\xi_{\text{SD}}\)</span>. The uniform distribution
function is shown in light grey in (a) and (b). Panel (c) shows the [BH]
critical values (green dots), the DBH step-down critical values (red
dots) and the sorted raw <span class="math inline">\(p\)</span>-values
(asterisks).</p>
<hr />
</div>
<div id="further-analyses" class="section level1">
<h1>2. Further Analyses</h1>
<div id="analysis-of-pharmacovigilance-data" class="section level2">
<h2>2.1. Analysis of Pharmacovigilance Data</h2>
<p>To illustrate how the procedures in <strong>DiscreteFDR</strong> can
be used for real data, we revisit the analysis of the pharmacovigilance
data from <a href="https://arxiv.org/abs/1112.4627v2">Heller and Gur
(2011)</a> performed in <a href="https://doi.org/10.1214/18-EJS1441">[DDR]</a>. This data set is
obtained from a database for reporting, investigating and monitoring
adverse drug reactions due to the Medicines and Healthcare products
Regulatory Agency in the United Kingdom. It contains the number of
reported cases of amnesia as well as the total number of adverse events
reported for each of the <span class="math inline">\(m = 2446\)</span>
drugs in the database. For more details we refer to <a href="https://arxiv.org/abs/1112.4627v2">Heller and Gur (2011)</a> and
to the accompanying R-package <strong>discreteMTP</strong> (<a href="https://CRAN.R-project.org/package=discreteMTP">Heller et
al. (2012)</a>) (no longer available on CRAN), which also contains the
data. <a href="https://arxiv.org/abs/1112.4627v2">Heller and Gur
(2011)</a> investigate the association between reports of amnesia and
suspected drugs by performing for each drug a Fisher’s exact test
(one-sided) for testing association between the drug and amnesia while
adjusting for multiplicity by using several (discrete) FDR procedures.
In what follows we present code that reproduces parts of Figure 2 and
Table 1 in <a href="https://doi.org/10.1214/18-EJS1441">[DDR]</a>.</p>
<p>We proceed as in the example in Section 1. Since we need to access
the critical values, we first determine the <span class="math inline">\(p\)</span>-values and their support for the data
set <code>amnesia</code> contained for convenience in the package
<strong>DiscreteFDR</strong>. For this, we use the option
<code>&quot;HG2011&quot;</code> in the function
<code>fisher.pvalues.support</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">data</span>(amnesia)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>amnesia.formatted <span class="ot">&lt;-</span> <span class="fu">fisher.pvalues.support</span>(amnesia[, <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">input =</span> <span class="st">&quot;HG2011&quot;</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>raw.pvalues <span class="ot">&lt;-</span> amnesia.formatted<span class="sc">$</span>raw</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>pCDFlist <span class="ot">&lt;-</span> amnesia.formatted<span class="sc">$</span>support</span></code></pre></div>
<p>Then we perform the FDR analysis with functions <code>DBH</code> and
<code>ADBH</code> (SU and SD) and <code>DBR</code> at level <span class="math inline">\(\alpha = 0.05\)</span> including critical
values.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>DBH.su  <span class="ot">&lt;-</span>  <span class="fu">DBH</span>(raw.pvalues, pCDFlist, <span class="at">ret.crit.consts =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>DBH.sd  <span class="ot">&lt;-</span>  <span class="fu">DBH</span>(raw.pvalues, pCDFlist, <span class="at">direction =</span> <span class="st">&quot;sd&quot;</span>, <span class="at">ret.crit.consts =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>ADBH.su <span class="ot">&lt;-</span> <span class="fu">ADBH</span>(raw.pvalues, pCDFlist, <span class="at">ret.crit.consts =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a>ADBH.sd <span class="ot">&lt;-</span> <span class="fu">ADBH</span>(raw.pvalues, pCDFlist, <span class="at">direction =</span> <span class="st">&quot;sd&quot;</span>, <span class="at">ret.crit.consts =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a>DBR.su  <span class="ot">&lt;-</span>  <span class="fu">DBR</span>(raw.pvalues, pCDFlist, <span class="at">ret.crit.consts =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>It is helpful to have a histogram of the observed <span class="math inline">\(p\)</span>-pvalues.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">hist</span>(DBH.sd)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>This histogram indicates a highly discrete <span class="math inline">\(p\)</span>~value distribution, which strongly
suggests the use of discrete methods.</p>
<p>By accessing the critical values we can now generate a plot similar
to Figure 2 from <a href="https://doi.org/10.1214/18-EJS1441">[DDR]</a>.
Note that both [DBH-SU] and [DBH-SD] are visually indistinguishable from
their adaptive counterparts.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">length</span>(raw.pvalues)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>crit.values.BH <span class="ot">&lt;-</span> <span class="fl">0.05</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">:</span>m) <span class="sc">/</span> m</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>scale.points <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">plot</span>(DBH.su, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;orange&quot;</span>), <span class="at">pch =</span> <span class="cn">NA</span>, <span class="at">type.crit =</span> <span class="st">&#39;p&#39;</span>, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">100</span>),</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, DBH.su<span class="sc">$</span>Critical.values[<span class="dv">100</span>]), <span class="at">ylab =</span> <span class="st">&quot;critical values&quot;</span>, <span class="at">cex =</span> scale.points, <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a></span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="fu">points</span>(crit.values.BH[<span class="dv">1</span><span class="sc">:</span><span class="dv">105</span>],          <span class="at">col =</span> <span class="st">&quot;green&quot;</span>,  <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> scale.points)</span>
<span id="cb13-9"><a href="#cb13-9" tabindex="-1"></a><span class="fu">points</span>(DBH.sd<span class="sc">$</span>Critical.values[<span class="dv">1</span><span class="sc">:</span><span class="dv">105</span>],  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>,    <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> scale.points)</span>
<span id="cb13-10"><a href="#cb13-10" tabindex="-1"></a><span class="fu">points</span>(ADBH.su<span class="sc">$</span>Critical.values[<span class="dv">1</span><span class="sc">:</span><span class="dv">105</span>], <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,   <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> scale.points)</span>
<span id="cb13-11"><a href="#cb13-11" tabindex="-1"></a><span class="fu">points</span>(ADBH.sd<span class="sc">$</span>Critical.values[<span class="dv">1</span><span class="sc">:</span><span class="dv">105</span>], <span class="at">col =</span> <span class="st">&quot;purple&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> scale.points)</span>
<span id="cb13-12"><a href="#cb13-12" tabindex="-1"></a><span class="fu">points</span>(DBR.su<span class="sc">$</span>Critical.values[<span class="dv">1</span><span class="sc">:</span><span class="dv">105</span>],  <span class="at">col =</span> <span class="st">&quot;yellow&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> scale.points)</span>
<span id="cb13-13"><a href="#cb13-13" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">sort</span>(raw.pvalues),                              <span class="at">pch =</span> <span class="dv">4</span>,  <span class="at">cex =</span> scale.points)</span>
<span id="cb13-14"><a href="#cb13-14" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Figure 2&quot;</span>, <span class="dv">1</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Critical values for [BH] (green dots), [DBH-SU] (orange dots),
[DBH-SD] (red dots), [A-DBH-SU] (blue dots), [A-DBH-SD] (purple dots),
[DBR] (yellow dots). The sorted raw <span class="math inline">\(p\)</span>-values are represented by
asterisks.</p>
<p>The rejected hypotheses can be accessed via the command
<code>$Indices</code>. The following code yields some of the values from
Table 1 in <a href="https://doi.org/10.1214/18-EJS1441">[DDR]</a>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a>rej.BH <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(<span class="fu">p.adjust</span>(raw.pvalues, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>) <span class="sc">&lt;=</span> <span class="fl">0.05</span>))</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a>rej.DBH.su <span class="ot">&lt;-</span> <span class="fu">length</span>(DBH.su<span class="sc">$</span>Indices)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a>rej.DBH.sd <span class="ot">&lt;-</span> <span class="fu">length</span>(DBH.sd<span class="sc">$</span>Indices)</span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a>rej.ADBH.su <span class="ot">&lt;-</span> <span class="fu">length</span>(ADBH.su<span class="sc">$</span>Indices)</span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a>rej.ADBH.sd <span class="ot">&lt;-</span> <span class="fu">length</span>(ADBH.sd<span class="sc">$</span>Indices)</span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a>rej.DBR.su <span class="ot">&lt;-</span> <span class="fu">length</span>(DBR.su<span class="sc">$</span>Indices)</span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="fu">c</span>(rej.BH, rej.DBH.su, rej.DBH.sd, rej.ADBH.su, rej.ADBH.sd, rej.DBR.su)</span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt; [1] 24 27 27 27 27 27</span></span></code></pre></div>
<p>The (continuous) BH rejects only 24 hypotheses whereas all the
discrete procedures implemented in <strong>DiscreteFDR</strong> are able
to identify three additional drug candidates potentially associated with
amnesia.</p>
</div>
<div id="other-types-of-discrete-tests" class="section level2">
<h2>2.2. Other Types of Discrete Tests</h2>
<p>In this section we sketch how can be used to analyze arbitrary
multiple discrete tests. <a href="https://doi.org/10.1002/bimj.201700284">Jiménez-Otero et
al. (2018)</a> used <strong>DiscreteFDR</strong> to detect disorder in
NGS experiments based on one-sample tests of the Poisson mean. Rather
than reproducing their analysis in detail, we illustrate the general
approach by using a toy example similar to the one in Section 1 and show
how the test of the Poisson mean can be accommodated by
<strong>DiscreteFDR</strong>.</p>
<p>To fix ideas, suppose we observe <span class="math inline">\(m =
9\)</span> independent Poisson distributed counts <span class="math inline">\(N_1, \ldots, N_9\)</span> (<a href="https://doi.org/10.1002/bimj.201700284">Jiménez-Otero et
al. (2018)</a> used this to model the read counts of different DNA
bases). We assume that <span class="math inline">\(N_i \sim
\text{Pois}(\lambda_i)\)</span> and the goal is to identify cases where
<span class="math inline">\(\lambda_i\)</span> is larger than some
pre-specified value <span class="math inline">\(\lambda^0_i\)</span>,
i.e., we have the (one-sided) multiple testing problem <span class="math display">\[H_{0i}: \lambda_i = \lambda^0_i \qquad \text{vs.}
\qquad H_{1i}: \lambda_i &gt; \lambda^0_i.\]</span> As in Section 1, the
goal is to adjust for multiple testing by using the [DBH-SD] procedure
at FDR-level <span class="math inline">\(\alpha = 5\%\)</span>. In our
example the observations <span class="math inline">\(n_1,\ldots,
n_9\)</span> and parameters <span class="math inline">\(\lambda^0_1,
\ldots, \lambda^0_9\)</span> are given as follows:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>lambda<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">1.2</span>, <span class="fl">0.7</span>, <span class="fl">1.3</span>, <span class="fl">1.0</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">1.3</span>, <span class="fl">0.9</span>)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>lambda.vector <span class="ot">&lt;-</span> lambda<span class="fl">.0</span></span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>observations <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a>configuration <span class="ot">&lt;-</span> <span class="fu">cbind</span>(observations, lambda<span class="fl">.0</span>)</span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">length</span>(observations)</span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="fu">print</span>(configuration)</span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt;       observations lambda.0</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt;  [1,]            3      0.6</span></span>
<span id="cb15-10"><a href="#cb15-10" tabindex="-1"></a><span class="co">#&gt;  [2,]            3      1.2</span></span>
<span id="cb15-11"><a href="#cb15-11" tabindex="-1"></a><span class="co">#&gt;  [3,]            1      0.7</span></span>
<span id="cb15-12"><a href="#cb15-12" tabindex="-1"></a><span class="co">#&gt;  [4,]            2      1.3</span></span>
<span id="cb15-13"><a href="#cb15-13" tabindex="-1"></a><span class="co">#&gt;  [5,]            3      1.0</span></span>
<span id="cb15-14"><a href="#cb15-14" tabindex="-1"></a><span class="co">#&gt;  [6,]            3      0.2</span></span>
<span id="cb15-15"><a href="#cb15-15" tabindex="-1"></a><span class="co">#&gt;  [7,]            1      0.8</span></span>
<span id="cb15-16"><a href="#cb15-16" tabindex="-1"></a><span class="co">#&gt;  [8,]            2      1.3</span></span>
<span id="cb15-17"><a href="#cb15-17" tabindex="-1"></a><span class="co">#&gt;  [9,]            4      0.9</span></span></code></pre></div>
<p>Denote by <span class="math inline">\(G_i\)</span> the distribution
of <span class="math inline">\(N_i\)</span> under <span class="math inline">\(H_{0i}\)</span> i.e., <span class="math inline">\(G_i(x) = P(N_i \le x)\)</span>. For observations
<span class="math inline">\(n_1,\ldots, n_9\)</span> of <span class="math inline">\(N_1, \ldots, N_9\)</span> the <span class="math inline">\(p\)</span>-values for the above one-sided test are
given by <span class="math display">\[p_i = P(N_i \ge n_i) = P(N_i &gt;
n_i - 1) = \overline{G_i}(n_i - 1),\]</span> where <span class="math inline">\(\overline{G_i}(x) = P(N_i &gt; x) = 1 -
G_i(x)\)</span> denotes the survival function of the Poisson
distribution with parameter <span class="math inline">\(\lambda^0_i\)</span>. Thus the raw <span class="math inline">\(p\)</span>-values are determined by the following
<strong>R</strong> code:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>raw.pvalues <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m,<span class="cf">function</span>(i){<span class="fu">ppois</span>(observations[i] <span class="sc">-</span> <span class="dv">1</span>, lambda.vector[i], <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)})</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">print</span>(raw.pvalues)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt; [1] 0.023115288 0.120512901 0.503414696 0.373176876 0.080301397 0.001148481</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt; [7] 0.550671036 0.373176876 0.013458721</span></span></code></pre></div>
<p>Following the definition of the function in <strong>R</strong> we
define the inverse function of <span class="math inline">\(\overline{G_i}\)</span> by <span class="math display">\[\left(\overline{G_i}\right)^{-1}(p) = \min\{n \in
\mathbb{N}: \overline{G_i}(n) \le  p\}\]</span> and obtain for the
distribution function of the <span class="math inline">\(i\)</span>-th
<span class="math inline">\(p\)</span>-value under the null <span class="math display">\[F_i(x) =
\overline{G_i}\left(\left(\overline{G_i}\right)^{-1}(x)\right).\]</span>
Each function <span class="math inline">\(F_i\)</span> is a step
function with <span class="math inline">\(F_i(0) = 0\)</span>, <span class="math inline">\(F_i(1) = 1\)</span> and there exists an infinite
sequence of jumps at locations <span class="math inline">\(1 = x_1 &gt;
x_2 &gt; \ldots &gt; x_n &gt; x_{n + 1} &gt; \ldots &gt; 0\)</span> such
that <span class="math inline">\(F(x_j) = x_j\)</span> for <span class="math inline">\(j \in \mathbb{N}\)</span>.</p>
<p>Initially it seems that we run into a problem if we want to determine
the critical values of [DBH-SD] since the supports of <span class="math inline">\(F_1, \ldots, F_9\)</span> are no longer finite
(but still discrete). We can deal with this problem by using the
observation from Section <span class="math inline">\(\ref{subsec:CritConsts}\)</span> that it is
sufficient to consider new, restricted supports <span class="math inline">\(\mathcal{A}_i \cap [s^{\tiny
\mbox{min}},1]\)</span> where the lower threshold satisfies <span class="math display">\[\begin{align}
  s^{\tiny \mbox{min}} &amp;\le \tau^{\tiny \mbox{min}}_1 = \max
\left\{t \in \mathcal{A}\::\: t \leq y^{\tiny \mbox{min}} \right\}
\qquad \text{where} \qquad y^{\tiny \mbox{min}} = \frac{\alpha}{m} \cdot
\left(1 + \frac{\alpha}{m} \right)^{-1}.
\end{align}\]</span> To determine such an <span class="math inline">\(s^{\tiny \mbox{min}}\)</span> we proceed as
follows. Define <span class="math inline">\(n^{\tiny \mbox{max}}_i =
\left(\overline{G_i}\right)^{-1}(y^{\tiny \mbox{min}}) + 1\)</span>,
<span class="math inline">\(t^{\tiny \mbox{min}}_i =
\overline{G_i}(n^{\tiny \mbox{max}}_i - 1)\)</span> and set <span class="math inline">\(s^{\tiny \mbox{min}} = \min\left(t^{\tiny
\mbox{min}}_1, \ldots, t^{\tiny \mbox{min}}_9 \right)\)</span>. It is
easily checked that this choice of <span class="math inline">\(s^{\tiny
\mbox{min}}\)</span> satisfies the above equation. We can determine
<span class="math inline">\(s^{\tiny \mbox{min}}\)</span> by the
following code</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>y.min <span class="ot">&lt;-</span> alpha<span class="sc">/</span>m <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> alpha<span class="sc">/</span>m)<span class="sc">^</span>(<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>n.max <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="cf">function</span>(w){<span class="fu">qpois</span>(y.min,        lambda.vector[w], <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)}) <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>t.min <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="cf">function</span>(w){<span class="fu">ppois</span>(n.max[w] <span class="sc">-</span> <span class="dv">1</span>, lambda.vector[w], <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)})</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>s.min <span class="ot">&lt;-</span> <span class="fu">min</span>(t.min)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="fu">print</span>(s.min)</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; [1] 0.0007855354</span></span></code></pre></div>
<p>For determining the restricted supports it is actually more
convenient to work with <span class="math inline">\(n^{\tiny
\mbox{max}}_i\)</span> than <span class="math inline">\(s^{\tiny
\mbox{min}}\)</span>. We can subsequently use these supports as the
<code>pCDFlist</code> argument in the usual way when calling the
<code>DBH</code> function:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>supports <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>m, <span class="cf">function</span>(w){<span class="fu">sort</span>(<span class="fu">ppois</span>(<span class="dv">0</span><span class="sc">:</span>n.max[w] <span class="sc">-</span> <span class="dv">1</span>, lambda.vector[w], <span class="at">lower.tail =</span> <span class="cn">FALSE</span>))})</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>DBH.sd <span class="ot">&lt;-</span> <span class="fu">DBH</span>(raw.pvalues, supports, <span class="at">direction =</span> <span class="st">&quot;sd&quot;</span>, <span class="at">ret.crit.consts =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>Figure 3 shows a summary similar to Figure 1. Applying the continuous
BH procedure</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="fu">p.adjust</span>(raw.pvalues, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.06934586 0.21692322 0.55067104 0.47979884 0.18067814 0.01033633 0.55067104</span></span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a><span class="co">#&gt; [8] 0.47979884 0.06056424</span></span></code></pre></div>
<p>results in one rejection at FDR-level <span class="math inline">\(\alpha = 5\%\)</span>, whereas the DBH step-up
procedure can reject three hypotheses:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>DBH.sd<span class="sc">$</span>Adjusted</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co">#&gt; [1] 0.039602625 0.101622881 0.580898946 0.522450788 0.101509307 0.001935955</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt; [7] 0.626257875 0.522450788 0.033073393</span></span></code></pre></div>
<p>This information can also be obtained by our <code>print</code>
method:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">print</span>(DBH.sd)</span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a><span class="co">#&gt;   Discrete Benjamini-Hochberg procedure (step-down) </span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co">#&gt; data:  raw.pvalues and pCDFlist </span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a><span class="co">#&gt; number of tests = 9 </span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a><span class="co">#&gt; number of rejections = 3 at global FDR level 0.05 </span></span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a><span class="co">#&gt; (Original BH rejections = 1)</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a><span class="co">#&gt; largest rejected p value:  0.02311529</span></span></code></pre></div>
<p>As in Figure 1, Panel (c) presents a graphical comparison between the
two procedures applied to the <span class="math inline">\(p\)</span>-values.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>stepf <span class="ot">&lt;-</span> <span class="fu">lapply</span>(supports, <span class="cf">function</span>(x) <span class="fu">stepfun</span>(x, <span class="fu">c</span>(<span class="dv">0</span>, x)))</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfcol =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="at">mai =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>))</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="fu">plot</span>(stepf[[<span class="dv">1</span>]], <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">do.points =</span> <span class="cn">FALSE</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">ylab =</span> <span class="st">&quot;F(x)&quot;</span>, </span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;(a)&quot;</span>)</span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> (<span class="dv">2</span><span class="sc">:</span><span class="dv">9</span>)){</span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a>  <span class="fu">plot</span>(stepf[[i]], <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">do.points =</span> <span class="cn">FALSE</span>, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> i)</span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a>}</span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#   Plot xi</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a>support <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(<span class="fu">unlist</span>(supports)))</span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a>components <span class="ot">&lt;-</span> <span class="fu">lapply</span>(stepf, <span class="cf">function</span>(s){<span class="fu">s</span>(support) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">s</span>(support))}) </span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a>xi.values <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">9</span> <span class="sc">*</span> <span class="fu">Reduce</span>(<span class="st">&#39;+&#39;</span>, components)</span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a>xi <span class="ot">&lt;-</span> <span class="fu">stepfun</span>(support, <span class="fu">c</span>(<span class="dv">0</span>, xi.values))</span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="fu">plot</span>(xi, <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.10</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.10</span>), <span class="at">do.points =</span> <span class="cn">FALSE</span>, <span class="at">ylab =</span> <span class="fu">expression</span>(xi), <span class="at">main =</span> <span class="st">&quot;(b)&quot;</span>)</span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co">#   Plot discrete critical values as well a BH constants</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a>DBH.sd <span class="ot">&lt;-</span> <span class="fu">DBH</span>(raw.pvalues, supports, <span class="at">direction =</span> <span class="st">&quot;sd&quot;</span>, <span class="at">ret.crit.consts =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="fu">plot</span>(DBH.sd, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">pch =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">19</span>), <span class="at">type.crit =</span> <span class="st">&#39;p&#39;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>),</span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a>     <span class="at">cex =</span> <span class="fl">1.3</span>, <span class="at">main =</span> <span class="st">&quot;(c)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Critical Values&quot;</span>)</span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="fl">0.05</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>) <span class="sc">/</span> <span class="dv">9</span>, <span class="at">col =</span> <span class="st">&quot;green&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">1.3</span>)</span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;Figure 3&quot;</span>, <span class="dv">1</span>, <span class="at">outer =</span> <span class="cn">TRUE</span>, <span class="at">line =</span> <span class="sc">-</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAA4VBMVEUAAAAAADoAAGYAOmYAOpAAZrYA/wAo4uU6AAA6ADo6AGY6OgA6OpA6ZmY6ZpA6ZrY6kNth0E9mAABmADpmAGZmOgBmOjpmOpBmZjpmZpBmZrZmkGZmkJBmkLZmkNtmtrZmtttmtv+QOgCQOjqQOmaQZjqQZmaQkGaQkJCQtraQ27aQ29uQ2/+enp62ZgC2Zjq2Zma2kLa2tma2tra2/7a2//++vr7NC7zbkDrbkJDbtmbbtrbbttvb25Db27bb29vb/7bb/9vb///fU2v1xxD/AAD/tmb/25D//7b//9v///9iGIR6AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAcqElEQVR4nO2dCVvlyHWGRU/TMHgSA92TyeoYehxnAZxlENdxJnYAXy76/z8oWu4ilap0T5VqOXX0vc88cAdxJJ2ul9pUkooKAMYUqU8AgCkgKGANBAWsgaCANRAUsAaCAtZAUMAaCApYA0EBa5IKurm+2X1cfXhMeSZhqPPbXH98bj5KzW/7KVx6SQVdndztPr6dX6Y8kzDU+e0ElZrf9lO49FIK+n7bFZ76WQpNTjtBpeY3/uiZlIK+nZ/WX74vim/qP8SHQ20qhSa/zfU3vylObsTm15bfLwOml1LQdXFZF+BpV8usipvjEXnR5Xdy835bl57Y/E6f/7v+Hiy9lIJ2Sf3hn35R1F3sJlthNPm1f3zr+oPQ/NZbMYOll1rQzfcn//C/1+IFvZSa30q6oOt+IQoDNagHUvdB18VpnWhdg4rtoxW/fr+VnN/H57XUPmg7CvxdPYj/TT2IEDrKXcYo/lnmKH4J86C6z1IQPw/av0C2uRbXRVtSfuHS43Itfi37WrX0/MKlh9VMgDUQFLAGggLWQFDAGggKWGMtaJEHzv8embCY/OwFdf2niYp7Afo8i3AsJz8I6ikwLsvJD4J6CozLcvJbrqDrtq+jrnHIIz3CaW6+NCuoCvUSeXb5LVbQ99v2Mt3bd8MSzCM9mqDrUwH5LVbQpoY5fLMIZAEpv9WlgPzMJ6xvAjPJkF6DXmRegCY21x9//lX97QepNaihCcwkQ8JZvp2L7oM2CZ7cvX2be37GEzY0gZlkuJxRbqzAuFjUoBcQlCHLyc98wvomMJMMl1OAsQLjglF8c7tlywexgyQZ+R074UMfdHQZnycl9Sw3n4eNQx7pVWX7VW5+HYJrUHIBVmvdjYjc0xOfX4dgQYveV+dw9iwnv6ULmv2VliNkn9/SBdWHs2c5+Zkn6vWjQOYZlsIFLbffpea3g1KDqqPAowEMKC1q0ByX2+38lJrfHlITrx0F8s7QQtAsl9tZCJplfnuE9kGb8qMKmuNyu72fQvM7AEGzXG5nI2iO+R0QKmgDuQ8qfbmdkPyWK+hUOHuWkx8E1YWzZzn5CRK0f5VaYgGWvc8S8+sjUdBt+YkVtO+nxPwGQFATbNODoNahvBheBJRXgAM/BeY3BIKa4JoeBLUP5YlUQYcsJz8Iqgtnz3Lyg6C6cPYsJz8hgqpXqaUVYKn8v7T8VKQJ2is/kYKqfkrLbwQENcEyPQjqFMqH8UVAWQU48lNYfmMgqAmO6UFQt1CeSBR0zHLyg6C6cPYsJz8Iqgtnz3LyEyCo7iq1pAIc90Bl5acDgprglx4EdQ1lglJ+4gTV+SkpPy0Q1AS79CCocygTIKgN/PLTIklQBXGCallOfhBUF86e5eQHQXXh7FlOfrkLaljnI6YAtT1QQfkZECOoaRmFlAI0+CkmPxMQ1ASv9CBo5oJqyk+UoCY/peRnBIKaYJUeBM1dUA2iBDWynPwgqC6cPcvJD4LqwtmznPxyFnTiKrWIAjT2QIXkN4EIQfXlJ0fQCT9F5DcFBDXBJz0IqnyyDk3M5EVAAQU45aeE/CaBoCbYpAdB1U/WoTwRI+gky8kPgurC2bOc/CCoLpw9y8kvV0GPXKXOvgAne6AC8jtC9oKay0+GoEf8zD6/Y0DQ6fDkQNDxJ+vQhBy9CJh5AR7zM/f8jgJBm9dVn/zrdfFh+Dp1HulB0NwFnYAq6PuPj5vPd9Xmh2dNOHsgKCGUJ1RBN18e6/+ab5pw9kBQUxPIPkPLGvTtO9SgDCEIamgCOWRIuEpNOMt1wbUPerQHCkErYxPIIUM/gk6FpyUrQWf+e0/udXLPhiaQQQlOl59FDdpwcqcLTwrBT0aCtnsMpP3wk4q+CWRQgn4Efb+9ab4x7INmJmi9yzDWq5+sQ1PhR9Bt34XhKD43QcNIT935oQCLLf7Pxiu2NeiFkl+wE/MKJ0FRg1phcSWJaR+UAiNBk/VBj4byRMAongCf/JKN4g2j3OQlSFvnQz5Ldn1QSg+Uk6BhoEwz6Ue5qTMkLqPItgBpfuabHxHaRH3vmy40CRC0Jdv8iFjUoBesBD1efnlP1BP9hKCVaZQrRlCeE/UQtAOjeMYT9RQgKCGUJ84T9f1w9kBQQihPMFEfJjAumQpKv0qdZwFSe6C55kcnT0FJ5ZexoHQ/88zPAgg6HZ4GCLonS0FtLgLmWIAWfmaZnw0QdDo8CRD0QJaC0shXUBuWkx8E1YWzZzn5QVBdOHuWk182gtpdpc6vAG16oDnmZ0d+gpLLL1NB7fzMLz9LIOh0eHwg6IDsBLW9CJhbAVr6mV1+tkDQ6fDoQNAh2Ql6TyZPQW1ZTn65CEr+TQgaJjAuEHQ6nD3LyS8LQUvhgtr2QHPLzx4IOh0eGQiqkpegpfAm3t7PvPJzAIJOh8cFgo6AoNPhcYGgI/IStBIuqAPLyQ+C6sLZs5z8+Av60nD/QgWChgmMS06Ctj00wTWoQw+UdJosH45GJSNBy5fmq1xBnfwknCbPh6NRgaDT4REJJaiUh6NxF7SsZAvq5qdFDZr7w9EgqC48HsEElfJwNO6CVsIFdWQ5+UFQXTh7lpMfBNWFs2c5+fEWtOmhSRbUsQdKGsVfd692/IBBUjja8hMsqLOflNNsXqY+CMnzXaQQVBceiaCCVuuPz+MfQlCPdOUnV1B3P/PIbwYQdDo8DjEExZWk4MgVdAbLyQ+C6sLZs5z8IKgunD1YbkcIDcyuhyZV0Bk9UCy3I4WGZV9+QgWd5SeW21FCwwJBp8ByO0JoUA7lJ1PQeX5iuR0lNCjl2YD7MyoQNExgXPgLerb/JLMGncly8luuoG/f3q1Hi33yK8BYgXGBoNX717tmCib7aZhYgXHhLmgZXtDNl8e3X6aahpnZA4WgDfomUIyg1e/u6kq0aiQdh4cGgh6BIKihCYySYRmjD/p+20zDqGsmI/39zQWCmppAOYJOhQcGgh6D0sTrm0A5giZcTAFBj0ERVN8EyhnFC1lMESswLtxH8REElbKYIlZgXOiCHgqwiHpbYLQa9ELJj3ygpPRPc326uS5uHAIZw7oGbXtoEa4kpVpMMb8HOjjNeqSwOh1NthACOcNZ0LKYx7yzjPT3N5feadZt3MPlaLKFEMgZiqD6UW4EQduvzjXoa/uVfJbx+6C+BX3/8afPdwusQQ2j3OAZlt0BYgmqEunvby6DPmjx8U+f1XqEEsgY2kR975suNAwQlALf/PxgUYNexL6SFEtQIXc9to8J+/XX5dWghlGuGEHFTNTXiTzcLLAPejw0EJEEFTNR34zib5Y4ij8aGoIyeg0a965HPz3QcQ2qfZLdkUDOcBW0rOL1QVNM1PvyU+2DjpftUgIZA0FNZChonMC4MBW0PBxApKDe/Bz0Qa81T/qmBHIGgprIT9CW9aVjIFOYCto7gEhB/aGeJkbx7gFuB4Cgk6inObqeQg1kCk9BX1uKVw33uh/qmXeW2RXgtg+KJt45gEzZd8u5Bn3q7cSBgAXorwfKMz+fcBS0rGQL6tPPw2ka3td1PHDGUUNK/uc/K4eAoENyEzRa4CE6rJ+doQwFLSvZgnr1c3Caq4jzoEV4P1tDIaiJ/ATdfL57uFmf2ge6HThoJ5azoJVwQf0yXM20inZPUuAalHMTX0FQC/qrmb7erU8jCRq8D6odJK1s5tEgKAv6p7n++H+3ceZBI4zih0dqPq273FbUW/8DnV3TRZMsqN8uaH+aiboSVAnkTU/Qv919+ndaIxEmw7b8BAvq2c/+ab6dkxeDVjkK6h7qEwhqx+A0LZ58k6Ogm6YOff8x6ZLsrvzkCurbz9FpPkheD7o+uVsn/hOEoJYMT5M8gMhT0Or9ljrNWwXNMIygf2xmYv5O7GqfpoEnT8FkmF/R9LJv1qPb3wmh3gkh6N/86ctjtfnyk9QFvZtrmyFSfvk1fdAfnhP3Qa+2vLZfi/br2dWA+ysqiqC/f/x9I+jj/6RLLwTMujDe4TWK3/XQQtSgf/nP//Ifz+TnboQpQO890EUJmn4etLzafgg0SHr/w3/R57ID/v35ZEGCpr+SFFpQKyAoCzhdiy8r2YKG8LM/SIq4oj4enPqgENQBRvkFgZOglXBBg9A/zZgr6mPRE5Q6QTgO9QYEtaY/UR91RX0khoKuyBfKKgjKg76gMVfUx4KPoE0PTbKgQXqgg9OMuaI+GmwEbctPsKCB/BycZrwV9fHoCWo5TQFBrYghaJzAuHAZxXflJ1fQUH4qNejz27cLfMvH0VAPQFBHhn1QzfvWCIGc4SJoh1xBgzEcxeP5oNpQb0BQa/o1aPO6Erzlwz3gOBDUmv5p4i0fhtDZ7F68fbX9/tp7qfbZ/tNL8+We/DZuRoK69UBpabqeEwSlU+52JbQGdRwhkc7gsJrpy094y4chdC4Q1P0MOOQXEg6ClpVsQV2nmGwFxSjeFDoTCDrjDPa/9H7b9UkxincOOL4rmYIGPQO1BvW79/RA0GPnlA4MkioIevyc0oEatGIhaMlB0PY69gCPXWxHhAq6fXTykR/tSC/o4cXbiQQ13A7p8e/PEetppofEN0SQ2D18fvpHeyBo80iqy4A1aDxBs3gd9/71HZM/OkAVdFyAnjLsvXg7XRO/Ovm3UILOWGcncqI+gKCmJwIIErR6vx091Q+ChiFAE69vAjGKD42loO1quwfyA15FDZJ0TaAcQddtA6FWodkJ+tDeLkc2NH1+JIh9UE0TKEbQtuYZ3yuRvgBtJ+ofe9887T09iUfx5XBXaaaZ9CXrpQBn3YpkeS3+x4ULesh87lLZA7vyY1GDXij5kQ9kZt6tcpZN/KpZJvJ+K/e+ePdQZ1gIWg8CQ/VBowra9aVlv+XDMdSVffkJHcXPvNdY5jSTJRRB9aNcaYIG6INC0PkQBDWMcsWM4o+cUzogaEW7kmSYv4CggYGglVUNeiFVUCET9SH2nh7apc4gfdBeD43FNJPvifrZj2OCoFXKUXy//CRO1FP9nPlMBghKCHWivD9Gof0p+QDOE/UVMXAasqDzDgNBCaEulH3TLGpQOmkn6skNPASdBIKagKAsSNfECxc01nHY5zcTCGpCjKDN6G81fuIIBD0CBPVyHJKgzdu9+K13JZFI0FK4oBZzoDEEXV0GWu8anjSCNuUnWVCbOfrwgl5//PlX9bcfUIOSgaB+jkMMfzs/uRu9nwaCmmnLT7CgVhc5MYqfBIKakCMo18Uw03z61H5LIuhLw/3LmKvt99f2a9F+PTtstjsKRvEdbO9aneTTp87QNII2X+xrUEsgaEfIu1aD8enT1lAIakKMoAHvWg1HUkFL4YLaLQQN3wcNd9dqQBI28aXwGtRyobLsUfzEU5eOkG6QBEH9HMcyPEkfdOq5dTTiC1oK74Pa3ukhuQadfPInDQhqwreg3l+2ud1t9EALshS0Ei5orP3Rd5twoj7HJr6CoHF3m3Sifq6fENSIGEGznKjfE1vQtocmWFDzECl5Der5rlWfbKeUdEQWtCs/uYJODOHT9UHZT9TvJuV1QFATcgT1HOid/WVNHXEF3ZafWEGn5kAXIKjjiAiCOgFBbXGeU2LUxHeIFTTm/ubu1vv5zJiV5zNI6oCgDHbLSdAJIKgJCGpLCD+jCrrvoQkVdHqZiHxB51820hBR0EP5yRT0yDKmBQgaAghqAoKyIJ6gvfITKajRT38v5tPuPXpgXCCoCX+Cup4BifwEnZhT0hBN0DOV+9FPDry2X4vuf2zPaweXUTwEHTA1K68hnqC9z1Y1qDMQNEzgPCava2qAoCYgaBC4CloKFzT+Mqa5e0cT36cUXoMmWCUyd+8YJPWBoKHIT1A74ghaCu+DTs7RQ9A5QFATEJQFGMWbwCieBRDUBASdJMTKJR0Q1AQEPTC2McjaTx1RBG26aJIFTbIQdO7eLQLHNpJXz9vNKWmIIWhbfoIFTbPObu7e6YEaG6mCWs7Ka4giqPHBbkewPaMhNq/jPp3zaJgFCkps4m2va2qIIGjZ/qJDDToTqqDNo2HWHx6dBT32QNDsBdXaSGzgIagZqqCtmZsvP0FQI84DojhNvL4JpGfIXND3r81TizZ/FerhWgIEdSfGIMnQBIoRtP4DbB7/Vqc4+CkEZQFBUEMTKEdQPRCUBZQaVN8EEjMs+Qs66xHZx9+ZAEHnQOuD6ppAWoZlxV7QWY/IJrzTA4LOIfQoPgNBZz0iG4IGhi7ooQAt5tHL/Z75CjrnXZaUlyJB0DkErkFzEHTOI7L1gnq9IHYEToLOnlPSEFbQ15biVce99qdbbM9FR7pRfMzKiZGg82flNVAE1Y9ySYIeftGqBvWCpaAeX9OyTEE9XNfUQJyor8ajXGmCqkBQS5IJahjlEjIshQtqfC2n6zEd4CNosibe8CKo4xmWT69PDcWTjnvtT31CO0v3ifpEjwvzdCxBgyT9KJck6OEX49egw12bcZ6oh6ARCDiKL6s8BHWdqI/+1kO/x4KguQjq+i5LCBqDoPOgeQjq/12WENQfENR7IAT1CQT1HihO0GLegeYRTNCmhyZZ0HTPs/N0LIvAYs5xZhJK0PKq5um1+XpVNF/OrhTu1R80OGQw5yzdAxM+LszTsWwCi/Fvh5jz1B96/Mk6VEPZuGZdgwYAgvoI1PgZydBAgpaVbEFTPuzG07Fm1aBhrrvrDz3+ZB06BoLGIk0fNHtB7/sU91qIu5oJRvGzA3Wj+Nyb+PvjNSh1VzOBoL4DOzIfJEHQWGCinhA6ohQuaNLn2Xk6ljEw1rOTaQQRtBRegyp++n5upBXe84v27GQaENQhUBXU9RA+8J0f+dnJkQghaCm8D6o28BA0IAEELcqiuC+u6pbu6fXQ6p31WsCXiG0iBLUM5OVnCEFfau5fruqvT6/N55ei+XL20sP1bB2INk+YiCiDpFhzShpCCFoda+JjAkHnB0abldcAQecHShc03nVNDf4FLYUL2u+Bxp9VGgFBCaF9SuE1aEn4nZigiSeE9oGgcYlyqVPQIKkU3gctCb8TFVyLJ4T2gKCR8S1oMW+v3sEofk4gg3L0nl8xZ6f+gaDugYnH79uT8B6ouUMuIRDUPZBFOQbIj0VeO/wK2vbQBAvKrgeKGpQUuqMrP7mCclpmt8N/H/TTJx6ZdfgV9GzHffv16bX9VrRf552nMxDULrBoZ+VZpNbiU9Cyk1Bfg6bCYwGyWma3w7egSa9raoCg9MC9oAnu7DACQQmhO4QLOn+fAZiZ33jxJy8/IahLoBxBdcvnWfkJQV0CxQjK7QYkDf4ELcd333Loq3kTdNsDTZ6QAgQlhDaUhbEGTYovQUv9j5Pjv4nnBQQlBsoUlNljRDT4ErSsZAta6n+cnoBrDVgAQWmBEDQRvgRV3gp/7/G97/PwfinQdX+BmJkfrzklDZ4EHT2mtqtBPZzgXCDoVCCzWXkNvgR9HTbxlVBBeU0xNczKj9t1TQ2eBC2FC8p1DA9BSaFVef/avA3pTHnlkRhBD5P0M8/GP2jiCaGNoIca9PBzcYLOPJcQYJBECC2vshZ0XRx52zHfBt5PfpyBoPv3xX/3bApsBWV2DX6Hj/w440PQoqgF7T2kdv8beQi6+fLY+2YMZFqg3vJjCkVQfRNxCGjuQXpt7zxSfiMPQXc1zIW5ALktYerhJT/GEAQ1NBH7gKea+9en4mmM//O1hlAOb+fH+miMC3NWfgV1F+kgCGpoIvYBu4Wg/k/OB/NH8SXb3Brm5XewlCsWNeiFXtCyvcbJ4Kq7ntmj3JJ3Cc7Mj9dTGjRQ+qD6JuIg6Fk7K8+U2aPc7AWdzo91cpWHUXx5X6R6JgOJuaPc2k/WZTgzPxE1aMchwcH9RiXv8nMZ5S4kv110LvnNWizCFy+jeMZgFE8I5YyXa/GMWU5+7hP1rCGfZfZXWo6QfX7OE/W8WU4NEyswLh4m6nmznAKMFRiX+RP1zFnOcjQjQvJznahnznKWo5mQkt9iR/FSlqOZkJLfYgWVshzNhJT8FivogifqMwCCeg+My3Lyg6CeAuOynPzsBc0D53+ZTFhMfo6ZTocd2WnKzUSk5+e8Y+Lh/e0MgjrsJf/8nHcMQXkUoPT8nHcMQXkUoPT8nHcMQXkUoPT8nHcMQXkUoPT8nHcMQXkUoPT8nHeci6AAxAGCAtZAUMAaCApYA0EBayAoYA0EBayBoIA1toKui+Jm+EG39f22KE4ngqtqdTmxeTUdrd+8vz9Me2YklOSUHQ23jlIc/csMU1Q2qzlQN3dZuqdowFBgY3TlNv4l0s5ov2Up6ObzXXcb1v6DduvqdHfTlnZzc8PMONH95rfvnqei9ZurzfWHR+UolijJKTtStqopjv5lhikqm9UcqJu7LN1TNKEvsDG6chv/kr6AnH7LVtBmr1/v+h+0WxvGf2uHze9f/3qc6H6z/q90+tDV+48/dTWofjMF5QjKjjTH75+oullJUdmspjh96MPmLkv3FKcgVI7acnPZUUUuJ0tB13Wl/HDT/6DdWmmemdPfvLrUJLHf/PD355rK/xD9dj56nETviNozI6Ekp+xonPogRXWzkqKyWU1RjVZS7J1Kc1D3FCfQFNgIbbmN0JffCEMxKoQStG6FzMH1H8+koB+fNf/+h0N/1LcNsQUdpqhsVlNUBVVSVA+tpBhBUF2BqejLbYS+/FRMxagQqIl/+1aT7qENb26LMvcAmuQmOgjNprXmL3QTt4lXUlTbcCVFZbOaoqYH0E+xdyqbME28tsBU9OU2Ql9+o50ZilEhzCBJ34Xvx2gS2G/WVxCHzc0fqCb/3cNe4gyS1GOM/2VWE4MkNUV1s5Ji71SaLP0Pksi7o9SgtAreVIwKTtNMbTNjnGaqtz7o/9T2wRPTTM3mlfbvdL/5wTzNZDwzEkpyummm/dZRiqN/Gc0002GzmqKyWU3x8C8XZprJUGBjqNNMlJ5AiGkmAOICQQFrIChgDQQFrIGggDUQFLAGggLWQFDAGggKWANBAWsgKGANBAWsgaCANRAUsAaCAtZAUMAaCApYA0EBayAocKD3GnrSAx/cgaDAgQUJ+tDcHk16FEWeyMzv7buf/+K6uedtVXzz/U1zE99poEyTC1o9XD6QHluVKyLzqwW9eNx8aW6+fjtvnlLR3GccJNP0gr7ffnw+/lv5IjK/WtD9EyYebtbdTctBMk0vKO0RPfkiMj9F0K7iDJJpckHrPvZaYBWzR2Z+O0GbB7Bc37x9e1enGSbT1IK+3zbPSZHXSdshNL+doPUg6eQX3SApUKapBQVgEggKWANBAWsgKGANBAWsgaCANRAUsAaCAtZAUMAaCApYA0EBayAoYA0EBayBoIA1EBSwBoIC1kBQwBoIClgDQQFrIChgDQS1p313dc3N5pr41JdVUQi89zgKENSeB9uba1cfHqs1DHUCgtpjK+jm+nJ7/zGwBoLasxe0a+LrFv/ktyd37f/UXzaff1vUNeaqfRrMAQjqBgS1ZyjoQ9N+Fz1Br5vNq7pFfzvvGbpCE+8EBLVnIOjbeVuL9gW93Lbq1bp2t2M9rE4BGQhqz3YUf9MK2km47gt6U22HRJ28HSIfchcBCGrPoAZd6QXdzUQdojCMdwKC2jMQdKoGHdCvTgEZCGqPpg+6agS9bC3ciXr4/e5XDh1SYAEEtUc/im86me+3u8tL7aD9YVuPNgECH1QfBQhqz3ge9MN/1pZuroviH6931z+bedB9nfkw7I4COhDUC2i/QwFBZ9J2MLtpTxAACDqXdYH2OyAQFLAGggLWQFDAGggKWANBAWsgKGANBAWsgaCANRAUsAaCAtZAUMAaCApY8//Vqp+CFY+0+wAAAABJRU5ErkJggg==" style="display: block; margin: auto;" /></p>
<p>Panel (a) depicts the distribution functions <span class="math inline">\(F_1, \ldots, F_9\)</span> in various colors, (b)
is a graph of the transformation function <span class="math inline">\(\xi_{\text{SD}}\)</span>. The uniform distribution
function is shown in light grey in (a) and (b). Panel (c) shows the [BH]
critical values (green dots), the DBH step-down critical values (red
dots) and the sorted raw <span class="math inline">\(p\)</span>-values
(asterisks).</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
